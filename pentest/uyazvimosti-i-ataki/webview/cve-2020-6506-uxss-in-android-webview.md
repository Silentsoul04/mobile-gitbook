# CVE-2020-6506: uXSS in Android WebView

## About

Уязвимость затрагивает вендоров, которые используют Android WebView с настройкой конфигурации по умолчанию и чьи приложения работают в системах с версией Android WebView до 83.0.4103.106.

В инстансе Android WebView с WebSettings.setSupportMultipleWindows\(\) = false \(или по умолчанию\), позволяет в iframe из другого origin обходить same-origin policy и исполнять JS код в верхнеуровневом документе.

Если не поддреживаются в WebView несколько окон, то новые окна с javascript:URL обрабатываются так же, какк новые окна с https://.

Чтобы вызвать атаку, iframe может вызывать window.open\(\) с url-адресом  javascript: URL. Другие методы открытия нового окна, такие как ссылка с target="\_blank" или href="javascript:..." так же могут сработать.

От пользователя требуется только одно взаимодействие - клик или нажатие клавиши, потому что webview требует взаимодействия, чтобы открыть новое окно.

В редких случаях взаимодействие с пользователем не требуется \(drive-by attack\). Страница верхнего уровня должна быть загружена с использованием схемы file://, а WebView должен установить для WebSettings.setJavaScriptCanOpenWindowsAutomatically\(\) и WebSettings.setAllowUniversalAccessFromFileURLs\(\) значения в true.

## Как понять, что приложение уязвимо?



## Links

uXSS \(CVE-2020-6506\) - Details [https://alesandroortiz.com/articles/uxss-android-webview-cve-2020-6506/](https://alesandroortiz.com/articles/uxss-android-webview-cve-2020-6506/)  
PoC: [https://alesandroortiz.com/security/chromiumwebview/cve-2020-6506.html](https://alesandroortiz.com/security/chromiumwebview/cve-2020-6506.html)

