# App Transport Security

App Transport Security - механизм, придуманный Apple для своих устройств как аналог HSTS  
[https://forums.developer.apple.com/thread/6767](https://forums.developer.apple.com/thread/6767)

### Check Client

Проверять как настроен ATS - в Info.plist  
Вот пример отключения ATS для приложения \(но вроде как не совсем, исключения составляют домены, объявленные в NSExceptionDomains\)

```text
<key>NSAppTransportSecurity</key>
<dict>
  <key>NSAllowsArbitraryLoads</key>
  <true/>
</dict>
```

The application may have ATS exceptions defined to allow it’s normal functionality. For an example, the Firefox iOS application has ATS disabled globally. This exception is acceptable because otherwise the application would not be able to connect to any HTTP website that does not have all the ATS requirements.

### Check Server

как проверить, настроен ли ATS на сервере:  
nscurl --ats-diagnostics [https://www.example.com](https://www.example.com)

Если на стороне сервера есть ошибки, лучше исправить их изменив конфигурацию, чем понижать уровень защищенности ATS клиента.

### Общие рекомендации

- ATS должен быть настроен в соответствии с лучшими практиками Apple и деактивирован только при определенных обстоятельствах \(например, 3th party not support ATS\)  
 - If the application opens third party web sites in web views, then from iOS 10 onwards NSAllowsArbitraryLoadsInWebContent can be used to disable ATS restrictions for the content loaded in web views

